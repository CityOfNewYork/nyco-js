<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <title>NYC Opportunity Patterns Framework</title>
    <link href="styles/site-default.css" rel="stylesheet" />
  </head>
  <body>
    <main class="container mx-auto">
      <h1>0.0.19</h1>
      <h1>NYCO Patterns Framework</h1>

<p>
  Command line utility for NYC Opportunity Patterns (
  <a href="https://accesspatterns.cityofnewyork.us">ACCESS NYC Patterns</a>
  ,
  <a href="https://nycopatterns.cityofnewyork.us">NYCO Patterns</a>
  ) + Cross-pattern utility library.
</p>

<ul>
  <li>
    üíÖ Compiles stylesheets using
    <a href="https://github.com/sass/node-sass">node-sass</a>
    and
    <a href="https://postcss.org/">PostCSS</a>
    .
  </li>
  <li>
    üóû Bundles JavaScript ES using
    <a href="https://rollupjs.org/guide/en/">rollup.js</a>
    .
  </li>
  <li>
    üóúÔ∏è SVG icon optimizer and sprite generator using
    <a href="https://github.com/svg/svgo">svgo</a>
    and
    <a href="https://github.com/svgstore/svgstore-cli">svgstore-cli</a>
    .
  </li>
  <li>
    ‚ú® Static site generator using
    <a href="https://github.com/slm-lang">slm-lang</a>
    .
  </li>
  <li>
    ü§ì Development environment using
    <a href="https://expressjs.com/">Express.js</a>
    .
  </li>
</ul>

<p>
  Each major package accepts a
  <a href="https://github.com/CityOfNewYork/nyco-patterns-framework/tree/master/config">custom configuration file</a>
  . Additionally, this package can be extended with additional npm packages and custom
  <a href="https://docs.npmjs.com/misc/scripts">npm scripts</a>
  .
</p>

<h2>Installation</h2>

<pre><code>$ npm install @nycopportunity/patterns-framework --save-dev

$ npm link @nycopportunity/patterns-framework</code></pre>

<p>
  <strong>$2</strong>
  Copy the
  <a href="https://github.com/CityOfNewYork/nyco-patterns-framework/tree/master/config">./config</a>
  directory into the root your pattern library.
</p>

<p>
  <strong>$3</strong>
  If you are using any of the
  <a href="#optional-dependencies">optional dependencies</a>
  used by the scripts in the &lt;u&gt;./config&lt;/u&gt; directory you will need to install them manually.
</p>

<p>
  <strong>$4</strong>
  <em>Recommended</em>
  . Add the following npm scripts to your Patterns Library;
</p>

<pre><code>&quot;scripts&quot;: {
  &quot;start&quot;: &quot;cross-env NODE_ENV=development cross-env PORT=7070 concurrently \&quot;pttrn default -w\&quot; \&quot;pttrn serve -w\&quot; -p \&quot;none\&quot;&quot;,
  &quot;default&quot;: &quot;cross-env NODE_ENV=production pttrn default&quot;,
  &quot;version&quot;: &quot;npm run default &amp;&amp; git add .&quot;,
  &quot;prepublishOnly&quot;: &quot;git push &amp;&amp; git push --tags&quot;,
  &quot;publish&quot;: &quot;cross-env NODE_ENV=production pttrn publish&quot;
},</code></pre>

<p>
  <strong>$5</strong>
  Start the development server (assuming you&#39;ve added the
  <a href="#npm-scripts">npm scripts</a>
  above to your package.json);
</p>

<pre><code>npm start</code></pre>

<h3>NPM Scripts</h3>

<p>
  The recommended
  <a href="https://docs.npmjs.com/misc/scripts">npm scripts</a>
  create shortcuts for using the cli.
</p>

<table>
  <thead>
    <tr>
      <th>Command</th>
      <th>Args</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>start</code></td>
      <td></td>
      <td>Starts the development environment.</td>
    </tr>
    <tr>
      <td><code>run default</code></td>
      <td></td>
      <td>Runs a one-off compilation of all assets to the distribution directory.</td>
    </tr>
    <tr>
      <td><code>version {{major/minor/patch}}</code></td>
      <td>major/minor/patch</td>
      <td>
        Runs the
        <code>default</code>
        script and creates a new release using
        <a href="https://docs.npmjs.com/cli/version">npm&#39;s semantic versioning command</a>
        .
      </td>
    </tr>
    <tr>
      <td><code>publish</code></td>
      <td></td>
      <td>
        Publish to the npm registry. This will run
        <code>prepublishOnly</code>
        and
        <code>publish</code>
        scripts in the recommended
        <a href="#npm-scripts">npm scripts</a>
        above as well which push all tags to GitHub. Publishing requires running the
        <code>version</code>
        script before publishing.
      </td>
    </tr>
  </tbody>
</table>

<h2>CLI</h2>

<p>
  Individal commands can be executed using the
  <code>pttrn</code>
  command which maps to this package&#39;s bin script. Avaliable commands can be seen below.
</p>

<pre><code>pttrn {{ command }}</code></pre>

<p>
  Each script has corresponding configuration files in the
  <strong>config/</strong>
  directory.
</p>

<h3>Commands</h3>

<table>
  <thead>
    <tr>
      <th>Command</th>
      <th>Configuration</th>
      <th>Optional&amp;nbsp;Flags</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>default</code></td>
      <td></td>
      <td>-w -n</td>
      <td>
        Lints files then asynchronously runs the
        <em>scripts</em>
        ,
        <em>styles</em>
        ,
        <em>svg</em>
        , and
        <em>build</em>
        scripts (detailed below).
      </td>
    </tr>
    <tr>
      <td><code>serve</code></td>
      <td></td>
      <td>-w -n</td>
      <td>Starts and Express app that serves the static files in the &lt;u&gt;./dist/&lt;/u&gt; directory.</td>
    </tr>
    <tr>
      <td><code>make</code></td>
      <td>&lt;u&gt;make.js&lt;/u&gt;</td>
      <td></td>
      <td>
        Starts a survey prompt for creating a new pattern using templates defined in the configuration.
        <a href="#make">More details below</a>
        .
      </td>
    </tr>
    <tr>
      <td><code>lint</code></td>
      <td>&lt;u&gt;package.json&lt;/u&gt;</td>
      <td></td>
      <td>
        Lints JS and SASS files in the &lt;u&gt;./src/&lt;/u&gt; directory using the
        <code>eslintConfig</code>
        and
        <code>stylelintConfig</code>
        objects in the &lt;u&gt;package.json&lt;/u&gt; file.
      </td>
    </tr>
    <tr>
      <td><code>rollup</code></td>
      <td>&lt;u&gt;rollup.js&lt;/u&gt;</td>
      <td>-w -n</td>
      <td>Runs Rollup.js, compiling pattern scripts defined in the configuration from ES Modules into CommonJS and/or iffe modules.</td>
    </tr>
    <tr>
      <td><code>styles</code></td>
      <td></td>
      <td>-w</td>
      <td>
        Syncronously runs the
        <em>variables</em>
        ,
        <em>sass</em>
        , and
        <em>postcss</em>
        scripts (detailed below).
      </td>
    </tr>
    <tr>
      <td><code>variables</code></td>
      <td>&lt;u&gt;variables.js&lt;/u&gt;</td>
      <td>-w -n</td>
      <td>Converts &lt;u&gt;./config/variables.js&lt;/u&gt; into &lt;u&gt;./src/config/_variables.scss&lt;/u&gt;.</td>
    </tr>
    <tr>
      <td><code>sass</code></td>
      <td>&lt;u&gt;sass.js&lt;/u&gt;</td>
      <td></td>
      <td>Processes pattern Sass stylesheets defined in the configuration into CSS.</td>
    </tr>
    <tr>
      <td><code>postcss</code></td>
      <td>&lt;u&gt;sass.js&lt;/u&gt;, &lt;u&gt;postcss.js&lt;/u&gt;</td>
      <td></td>
      <td>Runs PostCSS on Patterns CSS stylesheets defined in the &lt;u&gt;./config/sass.js&lt;/u&gt; into CSS. PostCSS plugins are defined in the configuration.</td>
    </tr>
    <tr>
      <td><code>svgs</code></td>
      <td></td>
      <td>-w -n</td>
      <td>Optimizes SVGS in the &lt;u&gt;./src/svg/&lt;/u&gt; directory into the &lt;u&gt;./dist/svg&lt;/u&gt; directory and creates an svg sprite for library icons in the &lt;u&gt;./dist/icons.svg&lt;/u&gt; file.</td>
    </tr>
    <tr>
      <td><code>slm</code></td>
      <td>&lt;u&gt;variables.js&lt;/u&gt;, &lt;u&gt;slm.js&lt;/u&gt;</td>
      <td>-w</td>
      <td>Compiles Slm Lang files in &lt;u&gt;./src/views/&lt;/u&gt; directory into static .html pages in the &lt;u&gt;./dist&lt;/u&gt; directory.</td>
    </tr>
    <tr>
      <td><code>locals</code></td>
      <td>&lt;u&gt;variables.js&lt;/u&gt;, &lt;u&gt;slm.js&lt;/u&gt;</td>
      <td></td>
      <td>This isn&#39;t a CLI script but it exports the local variables for the Slm Lang templates.</td>
    </tr>
    <tr>
      <td><code>publish</code></td>
      <td>&lt;u&gt;publish.js&lt;/u&gt;</td>
      <td></td>
      <td>
        Publishes the &lt;u&gt;./dist&lt;/u&gt; directory to the
        <code>gh-pages</code>
        branch of the repository.
      </td>
    </tr>
  </tbody>
</table>

<h3>Flags</h3>

<table>
  <thead>
    <tr>
      <th>Flag</th>
      <th>Full&amp;nbsp;Flag</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>-w</code></td>
      <td><code>--watch</code></td>
      <td>
        Use
        <a href="https://www.npmjs.com/package/nodemon">Nodemon</a>
        to watch source files and rerun the command when changes are made.
      </td>
    </tr>
    <tr>
      <td><code>-n</code></td>
      <td><code>--noisy</code></td>
      <td>
        Some commands use
        <a href="https://www.npmjs.com/package/shelljs">ShellJS</a>
        to execute other command line tasks. By default, their native output is silenced by configuring ShellJS to execute commands silently. This will allow those commands to show their native output.
      </td>
    </tr>
  </tbody>
</table>

<h3>Make</h3>

<p>
  Details about the make script to come. For now, refer to the documentation in the
  <a href="https://accesspatterns.cityofnewyork.us/developer-tools#make-script">ACCESS NYC Patterns &gt; Developer Tools &gt; Make Script documentation</a>
  .
</p>

<h2>Optional dependencies</h2>

<p>The following dependencies are optional as they are used by configuration files. If your pattern library uses them they will need to be added manually.</p>

<pre><code>autoprefixer
chalk
css-mqpacker
cssnano
eslint-config-google
node-emoji
rollup-plugin-babel
rollup-plugin-buble
rollup-plugin-commonjs
rollup-plugin-node-resolve
rollup-plugin-replace
stylelint-config-standard
tailwindcss</code></pre>

<h1>Troubleshooting</h1>

<ul>
  <li>
    Some scripts require setting the
    <code>NODE_ENV</code>
    version to
    <code>production</code>
    or
    <code>development</code>
    in order to run.
  </li>
  <li>
    <code>npm link</code>
    creates a symlink to
    <em>node_modules/@nycopportunity/patterns-framework</em>
    in the global node folder. If you are using
    <code>nvm</code>
    to manage versions of node, be sure you are using the correct version of node in your project directory.
  </li>
</ul>

<p>More details to come!</p>

<hr />

<p><img alt="The Mayor&#39;s Office for Economic Opportunity" src="NYCMOEO_SecondaryBlue256px.png" /></p>

<p>
  <a href="http://nyc.gov/opportunity">The Mayor&#39;s Office for Economic Opportunity</a>
  (NYC Opportunity) is committed to sharing open source software that we use in our products. Feel free to ask questions and share feedback.
  <strong>Interested in contributing?</strong>
  See our open positions on
  <a href="http://buildwithnyc.github.io/">buildwithnyc.github.io</a>
  . Follow our team on
  <a href="https://github.com/orgs/CityOfNewYork/teams/nycopportunity">Github</a>
  (if you are part of the
  <a href="https://github.com/CityOfNewYork/">@cityofnewyork</a>
  organization) or
  <a href="https://github.com/search?q=nycopportunity">browse our work on Github</a>
  .
</p>

    </main>
  </body>
</html>
