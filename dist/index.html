<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <title>NYC Opportunity Patterns Framework</title>
    <link href="styles/site-default.css" rel="stylesheet" />
  </head>

  <body>
    <main class="container mx-auto">
      <h1>0.0.12</h1><h1>NYCO Patterns Framework</h1>

<h2>Installation</h2>

<pre><code>$ npm install @nycopportunity/patterns-framework --save-dev

$ npm link @nycopportunity/patterns-framework</code></pre>

<p>Add the <a href="https://github.com/CityOfNewYork/nyco-patterns-framework/tree/master/config">./config</a> directory to the root your pattern library.</p>

<p>If you are using any of the <a href="#optional-dependencies">optional dependencies</a> used by the scripts in the &lt;u&gt;./config&lt;/u&gt; directory you will need to install them manually.</p>

<p><strong>Recommended</strong>. Add the following npm scripts to your Patterns Library;</p>

<pre><code>&quot;scripts&quot;: {
  &quot;start&quot;: &quot;cross-env NODE_ENV=development cross-env PORT=7070 concurrently \&quot;pttrn default -w\&quot; \&quot;pttrn serve -w\&quot; -p \&quot;none\&quot;&quot;,
  &quot;default&quot;: &quot;cross-env NODE_ENV=production pttrn default&quot;,
  &quot;version&quot;: &quot;npm run default &amp;&amp; git add .&quot;,
  &quot;prepublishOnly&quot;: &quot;git push &amp;&amp; git push --tags&quot;,
  &quot;publish&quot;: &quot;cross-env NODE_ENV=production pttrn publish&quot;
},</code></pre>

<p>Start the development server (assuming you&#39;ve added the npm scripts above to your package.json);</p>

<pre><code>npm start</code></pre>

<p><a href="#commands">CLI commands</a> can be executed using the <code>pttrn</code> command. Avaliable commands can be seen below.</p>

<pre><code>pttrn {{ command }}</code></pre>

<p>Versioning uses the default <code>npm version</code> command. This will run the <code>version</code> command in the recommended NPM Scripts.</p>

<pre><code>npm version {{ major/minor/patch }}</code></pre>

<p>Publishing to the registry uses the default <code>npm publish</code> command. This will run <code>prepublishOnly</code> and <code>publish</code> commands in the recommended NPM Scripts above as well which push all tags to GitHub. Publishing requires a new tag/version before publishing.</p>

<pre><code>npm publish</code></pre>

<p><strong>Upgrading a current NYC Opportunity Patterns Library</strong></p>

<p>Once the framework is installed as a dependency of the library you can delete the &lt;u&gt;.app/&lt;/u&gt; directory and remove any dependencies from the library listed in the framework&#39;s <a href="https://github.com/CityOfNewYork/nyco-patterns-framework/blob/master/package.json">package.json</a> dependency object. Keep in mind, you will need to keep any <a href="#optional-dependencies">optional dependencies</a> that the library is using. These may include specific plugins for Rollup and Vue.</p>

<p>Remove <strong>rollup-plugin-eslint</strong> from the &lt;u&gt;./config/rollup.js&lt;/u&gt; file if used. Linting is now done through a corresponding <a href="#scripts">Script</a>. Update esLint configuration in the &lt;u&gt;./package.json&lt;/u&gt; file</p>

<p>A few configuration files were renamed to keep parity with their corresponding <a href="#scripts">Scripts</a> name. Rename &lt;u&gt;./config/styles.js&lt;/u&gt; to &lt;u&gt;./config/sass.js&lt;/u&gt; and rename &lt;u&gt;./config/site.js&lt;/u&gt; to &lt;u&gt;./config/slm.js&lt;/u&gt;.</p>

<h2>Scripts</h2>

<p>The Patterns Framework is a Node.js application that uses various librariesâ€”including <a href="https://expressjs.com/">Express</a>, Rollup.js, Sass, PostCSS, Nodemon, and Concurrently to run a development server and build tasks for Style, JavaScript, SVG, and static page views. This is all managed via the cli command <code>pttrn {{ script }}</code> and <a href="https://docs.npmjs.com/misc/scripts">npm scripts</a> in the package.json. Configuration for the application can be found in the <strong>config/</strong> directory.</p>

<h3>Commands</h3>

<table>
  <thead>
    <tr>
      <th>Command</th>
      <th>Configuration</th>
      <th>Optional&amp;nbsp;Flags</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>default</code></td>
      <td></td>
      <td>-w -n</td>
      <td>Lints files then asynchronously runs the <em>scripts</em>, <em>styles</em>, <em>svg</em>, and <em>build</em> scripts (detailed below).</td>
    </tr>
    <tr>
      <td><code>serve</code></td>
      <td></td>
      <td>-w -n</td>
      <td>Starts and Express app that serves the static files in the &lt;u&gt;./dist/&lt;/u&gt; directory.</td>
    </tr>
    <tr>
      <td><code>make</code></td>
      <td>&lt;u&gt;make.js&lt;/u&gt;</td>
      <td></td>
      <td>Starts a survey prompt for creating a new pattern using templates defined in the configuration. <a href="#make">More details below</a>.</td>
    </tr>
    <tr>
      <td><code>lint</code></td>
      <td>&lt;u&gt;package.json&lt;/u&gt;</td>
      <td></td>
      <td>Lints JS and SASS files in the &lt;u&gt;./src/&lt;/u&gt; directory using the <code>eslintConfig</code> and <code>stylelintConfig</code> objects in the &lt;u&gt;package.json&lt;/u&gt; file.</td>
    </tr>
    <tr>
      <td><code>rollup </code></td>
      <td>&lt;u&gt;rollup.js&lt;/u&gt;</td>
      <td>-w -n</td>
      <td>Runs Rollup.js, compiling pattern scripts defined in the configuration from ES Modules into CommonJS and/or iffe modules.</td>
    </tr>
    <tr>
      <td><code>styles</code></td>
      <td></td>
      <td>-w</td>
      <td>Syncronously runs the <em>variables</em>, <em>sass</em>, and <em>postcss</em> scripts (detailed below).</td>
    </tr>
    <tr>
      <td><code>variables</code></td>
      <td>&lt;u&gt;variables.js&lt;/u&gt;</td>
      <td>-w -n</td>
      <td>Converts &lt;u&gt;./config/variables.js&lt;/u&gt; into &lt;u&gt;./src/config/_variables.scss&lt;/u&gt;.</td>
    </tr>
    <tr>
      <td><code>sass</code></td>
      <td>&lt;u&gt;sass.js&lt;/u&gt;</td>
      <td></td>
      <td>Processes pattern Sass stylesheets defined in the configuration into CSS.</td>
    </tr>
    <tr>
      <td><code>postcss</code></td>
      <td>&lt;u&gt;sass.js&lt;/u&gt;, &lt;u&gt;postcss.js&lt;/u&gt;</td>
      <td></td>
      <td>Runs PostCSS on Patterns CSS stylesheets defined in the &lt;u&gt;./config/sass.js&lt;/u&gt; into CSS. PostCSS plugins are defined in the configuration.</td>
    </tr>
    <tr>
      <td><code>svgs</code></td>
      <td></td>
      <td>-w -n</td>
      <td>Optimizes SVGS in the &lt;u&gt;./src/svg/&lt;/u&gt; directory into the &lt;u&gt;./dist/svg&lt;/u&gt; directory and creates an svg sprite for library icons in the &lt;u&gt;./dist/icons.svg&lt;/u&gt; file.</td>
    </tr>
    <tr>
      <td><code>slm</code></td>
      <td>&lt;u&gt;variables.js&lt;/u&gt;, &lt;u&gt;slm.js&lt;/u&gt;</td>
      <td>-w</td>
      <td>Compiles Slm Lang files in &lt;u&gt;./src/views/&lt;/u&gt; directory into static .html pages in the &lt;u&gt;./dist&lt;/u&gt; directory.</td>
    </tr>
    <tr>
      <td><code>locals</code></td>
      <td>&lt;u&gt;variables.js&lt;/u&gt;, &lt;u&gt;slm.js&lt;/u&gt;</td>
      <td></td>
      <td>This isn&#39;t a CLI script but it exports the local variables for the Slm Lang templates.</td>
    </tr>
    <tr>
      <td><code>publish</code></td>
      <td>&lt;u&gt;publish.js&lt;/u&gt;</td>
      <td></td>
      <td>Publishes the &lt;u&gt;./dist&lt;/u&gt; directory to the <code>gh-pages</code> branch of the repository.</td>
    </tr>
  </tbody>
</table>

<h3>Flags</h3>

<table>
  <thead>
    <tr>
      <th>Flag</th>
      <th>Full&amp;nbsp;Flag</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>-w</code></td>
      <td><code>--watch</code></td>
      <td>Use <a href="https://www.npmjs.com/package/nodemon">Nodemon</a> to watch source files and rerun the command when changes are made.</td>
    </tr>
    <tr>
      <td><code>-n</code></td>
      <td><code>--noisy</code></td>
      <td>Some commands use <a href="https://www.npmjs.com/package/shelljs">ShellJS</a> to execute other command line tasks. By default, their native output is silenced by configuring ShellJS to execute commands silently. This will allow those commands to show their native output.</td>
    </tr>
  </tbody>
</table>

<h2>Make</h2>

<p>Details about the make script to come. For now, refer to the documentation in the <a href="https://accesspatterns.cityofnewyork.us/developer-tools#make-script">ACCESS NYC Patterns, Developer Tools, Make Script documentation</a>.</p>

<h2>Optional dependencies</h2>

<p>The following dependencies are optional as they are used by configuration files. If your pattern library uses them they will need to be added manually.</p>

<pre><code>&quot;autoprefixer&quot;: &quot;^9.6.1&quot;,
&quot;chalk&quot;: &quot;^2.4.2&quot;,
&quot;css-mqpacker&quot;: &quot;^7.0.0&quot;,
&quot;cssnano&quot;: &quot;^4.1.10&quot;,
&quot;eslint-config-google&quot;: &quot;^0.13.0&quot;,
&quot;node-emoji&quot;: &quot;^1.10.0&quot;,
&quot;rollup-plugin-babel&quot;: &quot;^4.3.3&quot;,
&quot;rollup-plugin-buble&quot;: &quot;^0.19.8&quot;,
&quot;rollup-plugin-commonjs&quot;: &quot;^10.0.1&quot;,
&quot;rollup-plugin-node-resolve&quot;: &quot;^5.2.0&quot;,
&quot;rollup-plugin-replace&quot;: &quot;^2.2.0&quot;,
&quot;stylelint-config-standard&quot;: &quot;^18.2.0&quot;,
&quot;tailwindcss&quot;: &quot;^1.0.5&quot;</code></pre>

<p>More details to come!</p>
    </main>
  </body>

</html>